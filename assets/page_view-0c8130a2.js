import{a as e,j as a,b as t,r as n,i,f as u,T as s}from"./index-4d37af9a.js";const r=({children:t,event:n="page_view",data:i})=>{const{loading:u}=e();return u?t:a.jsx(d,{event:n,data:i,children:t})},d=({children:a,event:r="page_view",data:d})=>{const{guild:o}=t(),{loading:_}=e(),c=n.useRef(""),g=window.location.pathname,m=i.useFlags();return n.useEffect((()=>{const e=window&&window?.dataLayer?window?.dataLayer:[],a=e?.find((e=>"unleash_experiments"===e?.event));if(!a)return;let t={};if(window.location.search){const e=new URLSearchParams(window.location.search);t={utm_source:e.get("utm_source"),utm_medium:e.get("utm_medium"),utm_campaign:e.get("utm_campaign"),utm_term:e.get("utm_term"),utm_content:e.get("utm_content")}}const n={dataLayer:{event:r,...t,page_name:u(g),page_category:g.includes("dashboard")?"dashboard":"non_logged_website",page_url:g,page_previous_url:c.current,page_environment:"production",guild_buffs:o?.buffs,guild_discord_features:o?.features,guild_plugins:o?.plugins?Object.values(o.plugins).filter((e=>e?.config?.enabled)).map((e=>e.id)):[],guild_id:o?.id,guild_is_premium:o?.buffs?.includes("premium"),guild_member_count:o?.member_count,guild_category:o?.discord_usage,guild_is_business:o?.is_business,...d},dataLayerName:"dataLayer"};if(_)return;const i=e?.filter((e=>"page_view"===e?.event)).pop();i&&i?.page_url===g||(s.dataLayer(n),c.current=g)}),[location.pathname,_,m]),a};export{r as G};